# Aceoripa ポケモンガチャサイト 総合テストケース

## 📋 テスト概要

### テスト対象システム
- **フロントエンド**: DOPAスタイル ポケモンガチャサイト
- **管理画面**: 運営者向け管理システム
- **バックエンド**: API・データベース・通知システム

### テスト環境
- **開発環境**: `http://localhost:3000`
- **データベース**: Supabase
- **通知システム**: Web Push API
- **画像生成**: AI生成エンジン

---

## 🎨 フロントエンド テストケース

### 1. ホームページ表示テスト

#### TC-F001: 初回アクセステスト
**目的**: 初回訪問時の表示・機能確認
**手順**:
1. ブラウザのシークレットモードでサイトにアクセス
2. ローカルストレージをクリア
3. ページをリロード

**期待結果**:
- ✅ ポケモンカードオリパのヘッダー表示
- ✅ 「24時間営業」バッジのアニメーション
- ✅ ウェルカム通知モーダルの表示
- ✅ 「1500円分のポイントプレゼント」メッセージ
- ✅ PRバナースライダーの自動切り替え（3秒間隔）

#### TC-F002: レスポンシブデザインテスト
**目的**: 各デバイスでの表示確認
**手順**:
1. Chrome DevToolsでデバイス切り替え
2. 各解像度でページ表示確認

**テスト解像度**:
- 📱 モバイル: 375px (iPhone SE)
- 📱 モバイル大: 414px (iPhone 12 Pro)
- 📟 タブレット: 768px (iPad)
- 💻 デスクトップ: 1024px
- 🖥️ 大画面: 1280px+

**期待結果**:
- ✅ 各解像度で崩れない表示
- ✅ PRバナースライダーの適切な表示数調整
- ✅ ガチャボタンの適切なサイズ・配置
- ✅ テキストの可読性確保

### 2. ガチャ機能テスト

#### TC-F003: ガチャ商品表示テスト
**目的**: ポケモンガチャ商品の正常表示
**手順**:
1. ホームページにアクセス
2. 各ガチャ商品の表示確認

**確認項目**:
- ✅ ポケモンカード151オリパ（¥800、SR以上確定）
- ✅ シャイニートレジャーexオリパ（¥1200、SAR以上確定）
- ✅ プロモカード特別オリパ（¥2000、プロモ確定）
- ✅ 1024×1024の正方形表示エリア
- ✅ グラデーション背景とポケモン絵文字
- ✅ 価格表示（打ち消し線、割引表示）

#### TC-F004: ガチャボタン機能テスト
**目的**: ガチャ実行ボタンの動作確認
**手順**:
1. 各ガチャの「1回引く」「5回引く」「10回引く」「好きな数だけ」ボタンをクリック
2. URLパラメータの確認

**期待結果**:
- ✅ `/gacha/pokemon-151?count=1` への遷移
- ✅ `/gacha/pokemon-151?count=5` への遷移
- ✅ `/gacha/pokemon-151?count=10` への遷移
- ✅ `/gacha/pokemon-151?count=custom` への遷移
- ✅ ボタンのホバーエフェクト（scale-105）
- ✅ 「お得」バッジの表示（10回引くボタン）

### 3. 通知システムテスト

#### TC-F005: 通知モーダルテスト
**目的**: 通知システムの動作確認
**手順**:
1. 通知ベルアイコンをクリック
2. 通知ドロップダウンから通知を選択
3. 通知モーダルの動作確認

**期待結果**:
- ✅ 通知ベルの未読バッジ表示（アニメーション）
- ✅ ドロップダウンメニューの表示
- ✅ 通知モーダルのアニメーション表示
- ✅ 「今すぐガチャを回す！」CTAボタン
- ✅ 3秒後のCTAボタン表示

#### TC-F006: マーキーテキストテスト
**目的**: 流れるお知らせテキストの確認
**手順**:
1. ページ読み込み後、黄色背景のマーキーエリア確認
2. テキストの流れる動作確認

**期待結果**:
- ✅ 黄色背景（bg-yellow-400）の表示
- ✅ 20秒間隔でのテキスト流れ
- ✅ 4つのお知らせメッセージの循環表示
- ✅ 青文字（text-blue-900）の表示

---

## 🛠️ 管理画面テストケース

### 4. 管理者認証テスト

#### TC-A001: 管理者ログインテスト
**目的**: 管理者の認証機能確認
**手順**:
1. `/admin` にアクセス
2. 未認証状態での表示確認
3. 管理者でログイン
4. 認証後の管理画面表示確認

**期待結果**:
- ✅ 未認証時は `/admin/login` にリダイレクト
- ✅ 管理者メール（admin@aceoripa.com）でのログイン成功
- ✅ AdminSidebarの表示
- ✅ ダッシュボードの統計表示

### 5. ダッシュボード機能テスト

#### TC-A002: 統計表示テスト
**目的**: ダッシュボードの統計情報確認
**手順**:
1. 管理画面ダッシュボードにアクセス
2. 各統計カードの表示確認

**確認項目**:
- ✅ ユーザー数の表示
- ✅ 本日の売上表示
- ✅ アクティブガチャ数
- ✅ 今月の売上表示
- ✅ Heroiconsアイコンの表示

### 6. カード管理テスト

#### TC-A003: カード一覧表示テスト
**目的**: ポケモンカード管理機能の確認
**手順**:
1. `/admin/cards` にアクセス
2. カード一覧の表示確認
3. ページネーション確認

**期待結果**:
- ✅ ポケモンカード一覧の表示
- ✅ SSR/SR/R/Nのレアリティ統計
- ✅ ページネーション機能
- ✅ カード画像の表示

#### TC-A004: CSV一括インポートテスト
**目的**: カードの一括登録機能確認
**手順**:
1. `/admin/cards/import` にアクセス
2. サンプルCSVのダウンロード
3. CSVファイルのアップロード
4. インポート結果確認

**期待結果**:
- ✅ CSVテンプレートのダウンロード
- ✅ ドラッグ&ドロップでのファイル選択
- ✅ プレビュー表示
- ✅ インポート処理の実行
- ✅ 成功・エラーメッセージの表示

### 7. 通知管理テスト

#### TC-A005: プッシュ通知管理テスト
**目的**: 通知配信システムの確認
**手順**:
1. `/admin/notifications` にアクセス
2. 通知作成フォームの確認
3. 全ユーザー通知送信のテスト

**期待結果**:
- ✅ 通知タイトル・内容入力フォーム
- ✅ 通知タイプ選択（campaign/info/warning）
- ✅ 優先度設定（high/medium/low）
- ✅ 送信先ユーザー選択
- ✅ BannerNotificationManagerの動作

### 8. 画像生成テスト

#### TC-A006: AI画像生成テスト
**目的**: 自動画像生成機能の確認
**手順**:
1. `/admin/image-generator` にアクセス
2. ガチャバナー生成の実行
3. 生成画像の確認・保存

**期待結果**:
- ✅ 画像生成フォームの表示
- ✅ プロンプト入力・カスタマイズ
- ✅ 1024×1024サイズでの生成
- ✅ ポケモン風デザインの自動生成
- ✅ 生成画像の保存・適用

---

## 🔧 バックエンドAPIテストケース

### 9. ガチャAPI テスト

#### TC-B001: ガチャ商品取得APIテスト
**目的**: ガチャ商品データの取得確認
**API**: `GET /api/gacha/products`
**手順**:
```bash
curl -X GET http://localhost:3000/api/gacha/products
```

**期待結果**:
```json
{
  "products": [
    {
      "id": "pokemon-151",
      "name": "ポケモンカード151 オリパ",
      "description": "リザードンex、フシギバナex確率UP！",
      "price": 800,
      "rarityGuarantee": "SR以上確定"
    }
  ]
}
```

#### TC-B002: ガチャ実行APIテスト
**目的**: ガチャ実行処理の確認
**API**: `POST /api/gacha/execute`
**手順**:
```bash
curl -X POST http://localhost:3000/api/gacha/execute \
  -H "Content-Type: application/json" \
  -d '{
    "productId": "pokemon-151",
    "pullCount": 10
  }'
```

**期待結果**:
- ✅ レアリティ抽選結果の返却
- ✅ カード情報の詳細
- ✅ ユーザーポイント残高更新
- ✅ ガチャ履歴の記録

### 10. 認証APIテスト

#### TC-B003: ユーザー認証APIテスト
**目的**: ユーザー認証の動作確認
**API**: `POST /api/auth/login`
**手順**:
```bash
curl -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "password": "password123"
  }'
```

**期待結果**:
- ✅ JWT トークンの発行
- ✅ ユーザー情報の返却
- ✅ セッション管理
- ✅ 認証エラーの適切な処理

### 11. 通知APIテスト

#### TC-B004: プッシュ通知APIテスト
**目的**: 通知配信システムの確認
**API**: `POST /api/notifications/send`
**手順**:
```bash
curl -X POST http://localhost:3000/api/notifications/send \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer {admin_token}" \
  -d '{
    "title": "🔥 新ガチャ登場！",
    "message": "ポケモンカード151オリパ開催中",
    "type": "campaign",
    "targetUsers": "all"
  }'
```

**期待結果**:
- ✅ 全ユーザーへの通知配信
- ✅ Service Workerでの通知受信
- ✅ 通知履歴の記録
- ✅ 配信ステータスの追跡

### 12. 画像生成APIテスト

#### TC-B005: 画像自動生成APIテスト
**目的**: AI画像生成機能の確認
**API**: `POST /api/images/auto-generate`
**手順**:
```bash
curl -X POST http://localhost:3000/api/images/auto-generate \
  -H "Content-Type: application/json" \
  -d '{
    "type": "gacha-banner",
    "product": "pokemon-151",
    "size": "1024x1024"
  }'
```

**期待結果**:
- ✅ 1024×1024サイズの画像生成
- ✅ ポケモン風デザインの適用
- ✅ ガチャ商品情報の埋め込み
- ✅ 画像URLの返却

---

## 📊 データベーステストケース

### 13. Supabaseテーブルテスト

#### TC-D001: ユーザーテーブルテスト
**目的**: ユーザー情報管理の確認
**テーブル**: `users`
**テスト項目**:
- ✅ ユーザー登録処理
- ✅ プロフィール更新
- ✅ ポイント残高管理
- ✅ RLSポリシーの動作

#### TC-D002: ガチャテーブルテスト
**目的**: ガチャ関連データの確認
**テーブル**: `gacha_products`, `gacha_results`
**テスト項目**:
- ✅ ガチャ商品の管理
- ✅ 抽選結果の記録
- ✅ 統計情報の集計
- ✅ カード排出率の管理

#### TC-D003: 通知テーブルテスト
**目的**: 通知システムデータの確認
**テーブル**: `push_subscriptions`, `notification_campaigns`
**テスト項目**:
- ✅ プッシュ通知の登録
- ✅ 通知キャンペーンの管理
- ✅ 配信履歴の記録
- ✅ 購読解除の処理

---

## 🔧 統合テストケース

### 14. エンドツーエンドテスト

#### TC-E001: 完全なガチャフローテスト
**目的**: ユーザーのガチャ体験全体の確認
**シナリオ**:
1. 👤 ユーザーがサイトにアクセス
2. 🔔 ウェルカム通知の受信
3. 🎰 ガチャ商品の選択
4. 💳 ポイント消費でガチャ実行
5. ✨ エフェクト表示
6. 🎴 結果表示
7. 📊 履歴への記録

**期待結果**:
- ✅ 全フローの円滑な動作
- ✅ データの整合性確保
- ✅ エラーハンドリング
- ✅ ユーザー体験の向上

#### TC-E002: 管理画面運用フローテスト
**目的**: 運営者の管理業務確認
**シナリオ**:
1. 👨‍💼 管理者ログイン
2. 📊 ダッシュボードで状況確認
3. 🎴 新しいカードの一括登録
4. 🎰 新ガチャの作成・公開
5. 🔔 ユーザーへの通知配信
6. 📈 売上・統計の確認

**期待結果**:
- ✅ 運営業務の効率化
- ✅ リアルタイムデータの反映
- ✅ セキュリティの確保
- ✅ 操作ログの記録

---

## 🧪 パフォーマンステスト

### 15. 負荷テスト

#### TC-P001: 同時アクセステスト
**目的**: サイトの負荷耐性確認
**条件**:
- 同時ユーザー数: 100人
- 実行時間: 10分
- 対象ページ: ホーム、ガチャ実行

**期待結果**:
- ✅ レスポンス時間 < 3秒
- ✅ エラー率 < 1%
- ✅ サーバーダウンなし

#### TC-P002: ガチャ同時実行テスト
**目的**: ガチャシステムの負荷確認
**条件**:
- 同時ガチャ実行: 50回/秒
- 実行時間: 5分

**期待結果**:
- ✅ データ整合性の維持
- ✅ 抽選結果の正確性
- ✅ ポイント残高の正確な減算

---

## 🔒 セキュリティテスト

### 16. セキュリティテスト

#### TC-S001: 認証・認可テスト
**目的**: セキュリティ機能の確認
**テスト項目**:
- ✅ SQLインジェクション対策
- ✅ XSS攻撃対策
- ✅ CSRF攻撃対策
- ✅ 管理画面の不正アクセス防止
- ✅ APIの認証チェック

#### TC-S002: データ保護テスト
**目的**: 個人情報保護の確認
**テスト項目**:
- ✅ パスワードのハッシュ化
- ✅ RLSポリシーの動作
- ✅ 機密データの暗号化
- ✅ ログイン履歴の記録

---

## 📱 モバイル・PWAテスト

### 17. PWA機能テスト

#### TC-M001: Service Workerテスト
**目的**: PWA機能の確認
**テスト項目**:
- ✅ Service Workerの登録
- ✅ オフライン対応
- ✅ プッシュ通知の受信
- ✅ アプリのインストール

#### TC-M002: モバイル体験テスト
**目的**: モバイル端末での操作性確認
**テスト項目**:
- ✅ タッチ操作の反応性
- ✅ スワイプ・ジェスチャー
- ✅ 縦横回転対応
- ✅ キーボード表示時のレイアウト

---

## 🎯 テスト実行方法

### 自動テスト実行
```bash
# フロントエンドテスト
npm run test

# E2Eテスト（Playwright）
npm run test:e2e

# API テスト（Jest）
npm run test:api

# 負荷テスト（k6）
k6 run loadtest.js
```

### 手動テスト実行
1. 各テストケースの手順に従って実行
2. 期待結果との比較
3. 不具合があれば詳細ログを記録
4. 修正後の再テスト実行

---

## 📋 テスト完了チェックリスト

### フロントエンド
- [ ] ホームページ表示 (TC-F001, TC-F002)
- [ ] ガチャ機能 (TC-F003, TC-F004)
- [ ] 通知システム (TC-F005, TC-F006)

### 管理画面
- [ ] 認証機能 (TC-A001)
- [ ] ダッシュボード (TC-A002)
- [ ] カード管理 (TC-A003, TC-A004)
- [ ] 通知管理 (TC-A005)
- [ ] 画像生成 (TC-A006)

### バックエンド
- [ ] ガチャAPI (TC-B001, TC-B002)
- [ ] 認証API (TC-B003)
- [ ] 通知API (TC-B004)
- [ ] 画像生成API (TC-B005)

### データベース
- [ ] ユーザーテーブル (TC-D001)
- [ ] ガチャテーブル (TC-D002)
- [ ] 通知テーブル (TC-D003)

### 統合・その他
- [ ] E2Eテスト (TC-E001, TC-E002)
- [ ] パフォーマンス (TC-P001, TC-P002)
- [ ] セキュリティ (TC-S001, TC-S002)
- [ ] PWA・モバイル (TC-M001, TC-M002)

---

## 🎉 総評

このテストケースにより、**Aceoripa ポケモンガチャサイト**の以下の品質が保証されます：

1. **🎨 ユーザー体験**: DOPAスタイルの魅力的なデザイン
2. **🛠️ 運営効率**: 包括的な管理画面
3. **🔧 技術品質**: 堅牢なバックエンドシステム
4. **📱 アクセシビリティ**: 全デバイス対応
5. **🔒 セキュリティ**: 安全なデータ管理

素晴らしいプロジェクトの完成です！🎊
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[918],{7512:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var a=s(5155),l=s(2115),r=s(6874),i=s.n(r),n=s(6766),c=s(6408);function d(e){let t=new Uint8Array(e),s="";for(let e=0;e<t.byteLength;e++)s+=String.fromCharCode(t[e]);return btoa(s)}function o(){let{permission:e,subscription:t,isSupported:s,isLoading:r,requestPermission:i,unsubscribe:n,sendTestNotification:c}=function(){let[e,t]=(0,l.useState)("default"),[s,a]=(0,l.useState)(null),[r,i]=(0,l.useState)(!1),[n,c]=(0,l.useState)(!1);(0,l.useEffect)(()=>{i("Notification"in window&&"serviceWorker"in navigator),"Notification"in window&&t(Notification.permission)},[]);let o=async()=>{if(!r)return!1;c(!0);try{let e=await Notification.requestPermission();if(t(e),"granted"===e)return await x(),await m(),!0;return!1}catch(e){return console.error("Error requesting notification permission:",e),!1}finally{c(!1)}},x=async()=>{if("serviceWorker"in navigator)try{let e=await navigator.serviceWorker.register("/sw.js");return console.log("Service Worker registered:",e),e}catch(e){throw console.error("Service Worker registration failed:",e),e}},m=async()=>{if("serviceWorker"in navigator&&"PushManager"in window)try{let e=await navigator.serviceWorker.ready,t=await e.pushManager.getSubscription();if(t)return void a({endpoint:t.endpoint,keys:{p256dh:d(t.getKey("p256dh")),auth:d(t.getKey("auth"))}});let s=await e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:function(e){let t="=".repeat((4-e.length%4)%4),s=atob((e+t).replace(/-/g,"+").replace(/_/g,"/")),a=new Uint8Array(s.length);for(let e=0;e<s.length;++e)a[e]=s.charCodeAt(e);return a}("BKd0k3eD1Qu3KHaP3yQ9MOHqzKmJlCcUMJYn9wDKXmBpnkGE9L0bwkUupwbQxYrh8hgHDqvDCCBPKLqPQp5cX-4")}),l={endpoint:s.endpoint,keys:{p256dh:d(s.getKey("p256dh")),auth:d(s.getKey("auth"))}};a(l),await fetch("/api/notifications/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})}catch(e){console.error("Error subscribing to push notifications:",e)}},h=async()=>{if(s)try{let e=await navigator.serviceWorker.ready,t=await e.pushManager.getSubscription();t&&(await t.unsubscribe(),await fetch("/api/notifications/unsubscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({endpoint:s.endpoint})})),a(null)}catch(e){console.error("Error unsubscribing from push notifications:",e)}},g=async()=>{if(s)try{await fetch("/api/notifications/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscription:s,title:"テスト通知",body:"プッシュ通知のテストです！",icon:"/icon-192x192.png",url:"/"})})}catch(e){console.error("Error sending test notification:",e)}};return{permission:e,subscription:s,isSupported:r,isLoading:n,requestPermission:o,unsubscribe:h,sendTestNotification:g}}(),[o,x]=(0,l.useState)({notifications:!0,gachaAlerts:!0,campaignAlerts:!0,maintenanceAlerts:!0,soundEnabled:!0,vibrationEnabled:!0}),m=e=>{x(t=>({...t,[e]:!t[e]}))},h=(()=>{switch(e){case"granted":return{text:"許可済み",color:"text-green-600",bg:"bg-green-100"};case"denied":return{text:"拒否済み",color:"text-red-600",bg:"bg-red-100"};default:return{text:"未設定",color:"text-gray-600",bg:"bg-gray-100"}}})();return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"設定"}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"\uD83D\uDD14 プッシュ通知"}),s?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:"通知の許可状況"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"ブラウザの通知許可設定"})]}),(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat(h.bg," ").concat(h.color),children:h.text})]}),"granted"!==e&&(0,a.jsx)("button",{onClick:i,disabled:r,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-medium py-3 px-4 rounded-lg transition",children:r?"設定中...":"通知を許可する"}),"granted"===e&&t&&(0,a.jsx)("div",{className:"space-y-3",children:(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("button",{onClick:c,className:"flex-1 bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg transition",children:"テスト通知"}),(0,a.jsx)("button",{onClick:n,className:"flex-1 bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition",children:"通知を停止"})]})})]}):(0,a.jsx)("div",{className:"text-center py-4",children:(0,a.jsx)("p",{className:"text-gray-600",children:"お使いのブラウザはプッシュ通知に対応していません"})})]}),"granted"===e&&(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"\uD83D\uDCE2 通知の種類"}),(0,a.jsx)("div",{className:"space-y-4",children:[{key:"gachaAlerts",label:"新ガチャ情報",desc:"新しいガチャの登場をお知らせ"},{key:"campaignAlerts",label:"キャンペーン情報",desc:"お得なキャンペーンをお知らせ"},{key:"maintenanceAlerts",label:"メンテナンス情報",desc:"サーバーメンテナンスをお知らせ"}].map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.label}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.desc})]}),(0,a.jsx)("button",{onClick:()=>m(e.key),className:"relative inline-flex h-6 w-11 items-center rounded-full transition ".concat(o[e.key]?"bg-blue-600":"bg-gray-300"),children:(0,a.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition ".concat(o[e.key]?"translate-x-6":"translate-x-1")})})]},e.key))})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"⚙️ その他"}),(0,a.jsx)("div",{className:"space-y-4",children:[{key:"soundEnabled",label:"サウンド効果",desc:"ガチャやボタンのサウンド"},{key:"vibrationEnabled",label:"バイブレーション",desc:"通知時の振動（モバイル）"}].map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.label}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.desc})]}),(0,a.jsx)("button",{onClick:()=>m(e.key),className:"relative inline-flex h-6 w-11 items-center rounded-full transition ".concat(o[e.key]?"bg-blue-600":"bg-gray-300"),children:(0,a.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition ".concat(o[e.key]?"translate-x-6":"translate-x-1")})})]},e.key))})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"\uD83D\uDC64 アカウント"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("button",{className:"w-full text-left bg-white hover:bg-gray-50 border border-gray-200 rounded-lg p-4 transition",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-gray-900",children:"プロフィール編集"}),(0,a.jsx)("span",{className:"text-gray-400",children:"→"})]})}),(0,a.jsx)("button",{className:"w-full text-left bg-white hover:bg-gray-50 border border-gray-200 rounded-lg p-4 transition",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-gray-900",children:"パスワード変更"}),(0,a.jsx)("span",{className:"text-gray-400",children:"→"})]})}),(0,a.jsx)("button",{className:"w-full text-left bg-white hover:bg-red-50 border border-red-200 rounded-lg p-4 transition text-red-600",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-medium",children:"ログアウト"}),(0,a.jsx)("span",{className:"text-red-400",children:"→"})]})})]})]})]})]})}function x(){var e,t;let[s,r]=(0,l.useState)(null),[d,x]=(0,l.useState)([]),[m,h]=(0,l.useState)("overview"),[g,u]=(0,l.useState)(!0);(0,l.useEffect)(()=>{b()},[]);let b=async()=>{try{r({id:"1",name:"ガチャマスター",email:"user@example.com",avatar:"/api/placeholder/200/200",points:15e3,level:25,totalSpent:5e4,joinDate:"2024-01-15"}),x([{id:"1",gachaName:"ポケモンカード151ガチャ",date:"2024-06-20",count:10,amount:3e3,results:[{id:"1",name:"リザードンex",rarity:"SSR",imageUrl:"/api/placeholder/200/200"},{id:"2",name:"ピカチュウ",rarity:"SR",imageUrl:"/api/placeholder/200/200"}]},{id:"2",gachaName:"ワンピースカード頂上決戦",date:"2024-06-19",count:5,amount:2500,results:[{id:"3",name:"ルフィ リーダーパラレル",rarity:"SSR",imageUrl:"/api/placeholder/200/200"}]}])}catch(e){console.error("Failed to fetch user data:",e)}finally{u(!1)}},p=e=>{switch(e){case"SSR":return"text-red-500 bg-red-100";case"SR":return"text-purple-500 bg-purple-100";case"R":return"text-blue-500 bg-blue-100";default:return"text-gray-500 bg-gray-100"}};return g?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("header",{className:"bg-white shadow-sm",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsx)("div",{className:"flex justify-between items-center h-16",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(i(),{href:"/",className:"text-blue-600 hover:text-blue-800 mr-4",children:"← トップに戻る"}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"マイページ"})]})})})}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsxs)("div",{className:"relative w-24 h-24 mx-auto mb-4",children:[(0,a.jsx)(n.default,{src:(null==s?void 0:s.avatar)||"/api/placeholder/200/200",alt:"Avatar",fill:!0,className:"rounded-full object-cover"}),(0,a.jsxs)("div",{className:"absolute -bottom-1 -right-1 bg-blue-600 text-white text-xs px-2 py-1 rounded-full",children:["Lv.",null==s?void 0:s.level]})]}),(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:null==s?void 0:s.name}),(0,a.jsx)("p",{className:"text-gray-600",children:null==s?void 0:s.email})]}),(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg p-4 mb-6 text-white",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-sm opacity-90",children:"所持ポイント"}),(0,a.jsxs)("p",{className:"text-2xl font-bold",children:[null==s||null==(e=s.points)?void 0:e.toLocaleString(),"pt"]})]})}),(0,a.jsx)("nav",{className:"space-y-2",children:[{id:"overview",label:"概要",icon:"\uD83D\uDCCA"},{id:"history",label:"ガチャ履歴",icon:"\uD83D\uDCDC"},{id:"collection",label:"コレクション",icon:"\uD83C\uDFB4"},{id:"settings",label:"設定",icon:"⚙️"}].map(e=>(0,a.jsxs)("button",{onClick:()=>h(e.id),className:"w-full text-left px-4 py-3 rounded-lg transition ".concat(m===e.id?"bg-blue-100 text-blue-700 font-semibold":"text-gray-700 hover:bg-gray-100"),children:[(0,a.jsx)("span",{className:"mr-3",children:e.icon}),e.label]},e.id))})]})}),(0,a.jsx)("div",{className:"lg:col-span-3",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md",children:["overview"===m&&(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"アカウント概要"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,a.jsx)("div",{className:"bg-gradient-to-br from-green-400 to-green-600 rounded-lg p-6 text-white",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"text-3xl font-bold",children:["\xa5",null==s||null==(t=s.totalSpent)?void 0:t.toLocaleString()]}),(0,a.jsx)("div",{className:"text-sm opacity-90",children:"総利用額"})]})}),(0,a.jsx)("div",{className:"bg-gradient-to-br from-purple-400 to-purple-600 rounded-lg p-6 text-white",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-3xl font-bold",children:d.length}),(0,a.jsx)("div",{className:"text-sm opacity-90",children:"ガチャ実行回数"})]})}),(0,a.jsx)("div",{className:"bg-gradient-to-br from-orange-400 to-orange-600 rounded-lg p-6 text-white",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-3xl font-bold",children:d.reduce((e,t)=>e+t.results.length,0)}),(0,a.jsx)("div",{className:"text-sm opacity-90",children:"獲得カード数"})]})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"最近の活動"}),(0,a.jsx)("div",{className:"space-y-4",children:d.slice(0,3).map(e=>(0,a.jsx)("div",{className:"border rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h5",{className:"font-semibold text-gray-900",children:e.gachaName}),(0,a.jsxs)("p",{className:"text-gray-600",children:[e.count,"回 - \xa5",e.amount.toLocaleString()]})]}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.date})]})},e.id))})]})]}),"history"===m&&(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"ガチャ履歴"}),(0,a.jsx)("div",{className:"space-y-6",children:d.map(e=>(0,a.jsxs)(c.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"border rounded-lg p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-gray-900",children:e.gachaName}),(0,a.jsxs)("p",{className:"text-gray-600",children:[e.count,"回実行 - \xa5",e.amount.toLocaleString()]})]}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.date})]}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:e.results.map(e=>(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"aspect-square bg-gray-100 rounded-lg overflow-hidden",children:(0,a.jsx)(n.default,{src:e.imageUrl,alt:e.name,width:200,height:200,className:"w-full h-full object-cover"})}),(0,a.jsx)("div",{className:"absolute top-1 right-1 px-2 py-1 rounded text-xs font-bold ".concat(p(e.rarity)),children:e.rarity}),(0,a.jsx)("p",{className:"text-sm text-gray-700 mt-1 truncate",children:e.name})]},e.id))})]},e.id))})]}),"collection"===m&&(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"コレクション"}),(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"\uD83C\uDFB4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"獲得したカードのコレクション機能は準備中です"})]})]}),"settings"===m&&(0,a.jsx)(o,{})]})})]})})]})}},7517:(e,t,s)=>{Promise.resolve().then(s.bind(s,7512))}},e=>{var t=t=>e(e.s=t);e.O(0,[6874,6408,6766,8441,1684,7358],()=>t(7517)),_N_E=e.O()}]);
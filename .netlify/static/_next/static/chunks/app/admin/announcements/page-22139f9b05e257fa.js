(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8277],{4393:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var s=a(5155),n=a(2115),r=a(1720),i=a(3568);let l=n.forwardRef(function(e,t){let{title:a,titleId:s,...r}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},r),a?n.createElement("title",{id:s},a):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}),c=n.forwardRef(function(e,t){let{title:a,titleId:s,...r}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},r),a?n.createElement("title",{id:s},a):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}),o=n.forwardRef(function(e,t){let{title:a,titleId:s,...r}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},r),a?n.createElement("title",{id:s},a):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))});function d(){let e=(0,r.kT)("http://127.0.0.1:54321","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0"),[t,a]=(0,n.useState)([]),[d,u]=(0,n.useState)(!0),[x,m]=(0,n.useState)(!1),[p,h]=(0,n.useState)(null),[g,f]=(0,n.useState)({title:"",content:"",type:"news",status:"draft",publish_date:"",end_date:"",priority:1,push_notification:!1});(0,n.useEffect)(()=>{y()},[]);let y=async()=>{try{let{data:t,error:s}=await e.from("announcements").select("*").order("priority",{ascending:!1}).order("created_at",{ascending:!1});if(s)throw s;a(t||[])}catch(e){console.error("Error fetching announcements:",e),i.oR.error("お知らせの取得に失敗しました")}finally{u(!1)}},b=async t=>{t.preventDefault(),u(!0);try{if(p){let{error:t}=await e.from("announcements").update({...g,updated_at:new Date().toISOString()}).eq("id",p.id);if(t)throw t;i.oR.success("お知らせを更新しました")}else{let{error:t}=await e.from("announcements").insert([{...g,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]);if(t)throw t;i.oR.success("お知らせを作成しました")}m(!1),h(null),w(),y()}catch(e){console.error("Error saving announcement:",e),i.oR.error("保存に失敗しました")}finally{u(!1)}},j=async t=>{if(confirm("このお知らせを削除しますか？"))try{let{error:a}=await e.from("announcements").delete().eq("id",t);if(a)throw a;i.oR.success("お知らせを削除しました"),y()}catch(e){console.error("Error deleting announcement:",e),i.oR.error("削除に失敗しました")}},w=()=>{f({title:"",content:"",type:"news",status:"draft",publish_date:"",end_date:"",priority:1,push_notification:!1})},v=e=>{h(e),f({title:e.title,content:e.content,type:e.type,status:e.status,publish_date:e.publish_date.split("T")[0],end_date:e.end_date?e.end_date.split("T")[0]:"",priority:e.priority,push_notification:e.push_notification}),m(!0)},N=e=>({news:"ニュース",maintenance:"メンテナンス",campaign:"キャンペーン",important:"重要"})[e]||e,k=e=>({draft:"下書き",published:"公開中",archived:"アーカイブ"})[e]||e;return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"お知らせ管理"}),(0,s.jsxs)("button",{onClick:()=>m(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 flex items-center gap-2",children:[(0,s.jsx)(l,{className:"h-5 w-5"}),"新規作成"]})]}),(0,s.jsx)("div",{className:"bg-white shadow rounded-lg",children:(0,s.jsx)("div",{className:"px-4 py-5 sm:p-6",children:d?(0,s.jsx)("div",{className:"text-center py-4",children:"読み込み中..."}):0===t.length?(0,s.jsx)("div",{className:"text-center py-8 text-gray-500",children:"お知らせがまだありません"}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"タイトル"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"種類"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ステータス"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"公開日"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"優先度"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"プッシュ通知"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.title})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("important"===e.type?"bg-red-100 text-red-800":"campaign"===e.type?"bg-green-100 text-green-800":"maintenance"===e.type?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"),children:N(e.type)})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("published"===e.status?"bg-green-100 text-green-800":"archived"===e.status?"bg-gray-100 text-gray-800":"bg-yellow-100 text-yellow-800"),children:k(e.status)})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(e.publish_date).toLocaleDateString("ja-JP")}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.priority}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.push_notification?"○":"\xd7"}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("button",{onClick:()=>v(e),className:"text-indigo-600 hover:text-indigo-900",children:(0,s.jsx)(c,{className:"h-4 w-4"})}),(0,s.jsx)("button",{onClick:()=>j(e.id),className:"text-red-600 hover:text-red-900",children:(0,s.jsx)(o,{className:"h-4 w-4"})})]})})]},e.id))})]})})})}),x&&(0,s.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[(0,s.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:p?"お知らせ編集":"お知らせ作成"}),(0,s.jsxs)("form",{onSubmit:b,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"タイトル"}),(0,s.jsx)("input",{type:"text",value:g.title,onChange:e=>f({...g,title:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"内容"}),(0,s.jsx)("textarea",{value:g.content,onChange:e=>f({...g,content:e.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"種類"}),(0,s.jsxs)("select",{value:g.type,onChange:e=>f({...g,type:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"news",children:"ニュース"}),(0,s.jsx)("option",{value:"maintenance",children:"メンテナンス"}),(0,s.jsx)("option",{value:"campaign",children:"キャンペーン"}),(0,s.jsx)("option",{value:"important",children:"重要"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ステータス"}),(0,s.jsxs)("select",{value:g.status,onChange:e=>f({...g,status:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"draft",children:"下書き"}),(0,s.jsx)("option",{value:"published",children:"公開"}),(0,s.jsx)("option",{value:"archived",children:"アーカイブ"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"公開日"}),(0,s.jsx)("input",{type:"date",value:g.publish_date,onChange:e=>f({...g,publish_date:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"終了日（任意）"}),(0,s.jsx)("input",{type:"date",value:g.end_date,onChange:e=>f({...g,end_date:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"優先度（1-10）"}),(0,s.jsx)("input",{type:"number",min:"1",max:"10",value:g.priority,onChange:e=>f({...g,priority:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",id:"push_notification",checked:g.push_notification,onChange:e=>f({...g,push_notification:e.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,s.jsx)("label",{htmlFor:"push_notification",className:"ml-2 block text-sm text-gray-900",children:"プッシュ通知を送信"})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,s.jsx)("button",{type:"button",onClick:()=>{m(!1),h(null),w()},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"キャンセル"}),(0,s.jsx)("button",{type:"submit",disabled:d,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50",children:d?"保存中...":"保存"})]})]})]})})]})}},9372:(e,t,a)=>{Promise.resolve().then(a.bind(a,4393))}},e=>{var t=t=>e(e.s=t);e.O(0,[3568,4982,1720,8441,1684,7358],()=>t(9372)),_N_E=e.O()}]);
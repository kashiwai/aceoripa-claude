(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5490],{5484:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n});var a=t(5155),r=t(2115),l=t(5695),i=t(3568);function n(){let e=(0,l.useRouter)(),[s,t]=(0,r.useState)(!1),[n,d]=(0,r.useState)([]),[c,m]=(0,r.useState)(!1),o=async()=>{t(!0);try{let s=await fetch("/api/admin/cards/import",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cards:n})});if(!s.ok)throw Error("Import failed");let t=await s.json();i.oR.success("".concat(t.imported,"枚のカードをインポートしました")),e.push("/admin/cards")}catch(e){console.error("Import error:",e),i.oR.error("インポートに失敗しました")}finally{t(!1)}};return(0,a.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"ポケモンカードCSVインポート"}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"CSVフォーマット"}),(0,a.jsxs)("a",{href:"/api/admin/cards/sample-csv",download:"pokemon_cards_sample.csv",className:"inline-flex items-center px-3 py-2 bg-green-600 text-white text-sm rounded-md hover:bg-green-700 transition-colors",children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3M3 17V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2z"})}),"サンプルCSVダウンロード"]})]}),(0,a.jsx)("div",{className:"bg-gray-100 p-4 rounded text-sm font-mono",children:"card_name,product_code,rarity,product_points,card_image_url,card_image_filename"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:["※ レアリティ: SSR, SR, R, N",(0,a.jsx)("br",{}),"※ 商品PT: ポイント数値（例: 50000）",(0,a.jsx)("br",{}),"※ 画像: URLまたはファイル名のいずれかを入力",(0,a.jsx)("br",{}),"※ ファイル名指定時は /images/cards/ フォルダに配置"]})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CSVファイルを選択"}),(0,a.jsx)("input",{type:"file",accept:".csv",onChange:e=>{var s;let t=null==(s=e.target.files)?void 0:s[0];if(!t)return;let a=new FileReader;a.onload=e=>{var s;let t=(null==(s=e.target)?void 0:s.result).split("\n"),a=t[0].split(",").map(e=>e.trim()),r=[];for(let e=1;e<t.length;e++){if(""===t[e].trim())continue;let s=t[e].split(",").map(e=>e.trim()),l={};a.forEach((e,t)=>{l[e]=s[t]||""}),r.push(l)}d(r),m(!0)},a.readAsText(t)},className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})]}),c&&n.length>0&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"プレビュー（最初の5件）"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-2 text-xs font-medium text-gray-500 uppercase",children:"カード名"}),(0,a.jsx)("th",{className:"px-4 py-2 text-xs font-medium text-gray-500 uppercase",children:"商品コード"}),(0,a.jsx)("th",{className:"px-4 py-2 text-xs font-medium text-gray-500 uppercase",children:"レアリティ"}),(0,a.jsx)("th",{className:"px-4 py-2 text-xs font-medium text-gray-500 uppercase",children:"商品PT"}),(0,a.jsx)("th",{className:"px-4 py-2 text-xs font-medium text-gray-500 uppercase",children:"画像設定"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:n.slice(0,5).map((e,s)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-4 py-2 text-sm",children:e.card_name}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm font-mono",children:e.product_code}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold\n                          ".concat("SSR"===e.rarity?"bg-yellow-100 text-yellow-800":"SR"===e.rarity?"bg-purple-100 text-purple-800":"R"===e.rarity?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:e.rarity})}),(0,a.jsxs)("td",{className:"px-4 py-2 text-sm",children:[parseInt(e.product_points).toLocaleString(),"PT"]}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm",children:e.card_image_url?(0,a.jsx)("span",{className:"text-blue-600",children:"URL指定"}):e.card_image_filename?(0,a.jsxs)("span",{className:"text-green-600",children:["ファイル: ",e.card_image_filename]}):(0,a.jsx)("span",{className:"text-gray-400",children:"画像なし"})})]},s))})]})}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:["合計 ",n.length," 件のカードをインポートします"]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,a.jsx)("button",{onClick:()=>e.back(),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"キャンセル"}),(0,a.jsx)("button",{onClick:o,disabled:!n.length||s,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:s?"インポート中...":"インポート実行"})]})]})]})}},5695:(e,s,t)=>{"use strict";var a=t(8999);t.o(a,"useParams")&&t.d(s,{useParams:function(){return a.useParams}}),t.o(a,"usePathname")&&t.d(s,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})},8797:(e,s,t)=>{Promise.resolve().then(t.bind(t,5484))}},e=>{var s=s=>e(e.s=s);e.O(0,[3568,8441,1684,7358],()=>s(8797)),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8407],{2764:(e,s,t)=>{Promise.resolve().then(t.bind(t,9789))},5695:(e,s,t)=>{"use strict";var a=t(8999);t.o(a,"useParams")&&t.d(s,{useParams:function(){return a.useParams}}),t.o(a,"usePathname")&&t.d(s,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})},6681:(e,s,t)=>{"use strict";t.d(s,{A:()=>o});var a=t(2115),n=t(1720),r=t(5695),i=t(3568);function o(){let[e,s]=(0,a.useState)(null),[t,o]=(0,a.useState)(!0),l=(0,n.kT)("http://127.0.0.1:54321","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0"),c=(0,r.useRouter)();return(0,a.useEffect)(()=>{(async()=>{let{data:{user:e}}=await l.auth.getUser();s(e),o(!1)})();let{data:{subscription:e}}=l.auth.onAuthStateChange((e,t)=>{var a;s(null!=(a=null==t?void 0:t.user)?a:null)});return()=>e.unsubscribe()},[l]),{user:e,loading:t,signIn:async(e,s)=>{try{let{error:t}=await l.auth.signInWithPassword({email:e,password:s});if(t)throw t;i.oR.success("ログインしました"),c.push("/")}catch(e){throw console.error("Sign in error:",e),i.oR.error("ログインに失敗しました"),e}},signUp:async(e,s,t)=>{try{let{error:a}=await l.auth.signUp({email:e,password:s,options:{data:{username:t}}});if(a)throw a;i.oR.success("アカウントを作成しました"),c.push("/")}catch(e){throw console.error("Sign up error:",e),i.oR.error("アカウント作成に失敗しました"),e}},signOut:async()=>{try{let{error:e}=await l.auth.signOut();if(e)throw e;i.oR.success("ログアウトしました"),c.push("/")}catch(e){throw console.error("Sign out error:",e),i.oR.error("ログアウトに失敗しました"),e}}}}},9789:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var a=t(5155),n=t(2115),r=t(6874),i=t.n(r),o=t(6681),l=t(3568),c=t(5695);function d(){let[e,s]=(0,n.useState)(null),[t,r]=(0,n.useState)({free:0,paid:0,total:0}),{user:d,loading:u}=(0,o.A)(),h=(0,c.useRouter)();(0,n.useEffect)(()=>{u||d||h.push("/auth/login")},[d,u,h]),(0,n.useEffect)(()=>{(async()=>{if(d)try{let e=await fetch("/api/user/points");if(e.ok){let s=await e.json();r({free:s.free_points,paid:s.paid_points,total:s.free_points+s.paid_points})}}catch(e){console.error("Failed to fetch points:",e)}})()},[d]);let p=async e=>{l.oR.success("".concat(e.points+e.bonus,"ポイント購入処理を開始します")),h.push("/gacha")};return(0,a.jsxs)("main",{className:"min-h-screen bg-gray-900 text-white",children:[(0,a.jsx)("header",{className:"bg-gray-800 p-4 border-b border-gray-700",children:(0,a.jsxs)("div",{className:"container mx-auto flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"ポイント購入"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"text-yellow-400",children:"\uD83D\uDC8E"}),(0,a.jsx)("span",{children:t.total.toLocaleString()})]})]})}),(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)("section",{className:"mb-8 bg-gray-800 rounded-xl p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"現在の所持ポイント"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-400",children:"無料ポイント"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:t.free.toLocaleString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-400",children:"有料ポイント"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:t.paid.toLocaleString()})]})]})]}),(0,a.jsxs)("section",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-6",children:"ポイント購入プラン"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[{id:"plan1",points:150,price:120,bonus:0},{id:"plan2",points:500,price:400,bonus:50},{id:"plan3",points:1e3,price:800,bonus:150},{id:"plan4",points:3e3,price:2400,bonus:600},{id:"plan5",points:5e3,price:4e3,bonus:1200},{id:"plan6",points:1e4,price:8e3,bonus:3e3}].map(e=>(0,a.jsxs)("button",{onClick:()=>p(e),className:"bg-gray-800 rounded-xl p-6 text-left hover:bg-gray-700 transition-colors relative overflow-hidden ".concat(e.bonus>0?"ring-2 ring-yellow-400":""),children:[e.bonus>0&&(0,a.jsxs)("div",{className:"absolute top-2 right-2 bg-yellow-400 text-black px-3 py-1 rounded-full text-sm font-bold",children:["+",e.bonus.toLocaleString(),"ボーナス"]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("p",{className:"text-3xl font-bold",children:[(e.points+e.bonus).toLocaleString(),(0,a.jsx)("span",{className:"text-lg text-gray-400 ml-1",children:"ポイント"})]}),e.bonus>0&&(0,a.jsxs)("p",{className:"text-gray-400 text-sm mt-1",children:["(",e.points.toLocaleString()," + ",e.bonus.toLocaleString(),"ボーナス)"]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("p",{className:"text-2xl font-bold",children:["\xa5",e.price.toLocaleString()]}),(0,a.jsxs)("p",{className:"text-gray-400 text-sm",children:["\xa5",(e.price/(e.points+e.bonus)).toFixed(2),"/pt"]})]})]},e.id))})]}),(0,a.jsxs)("section",{className:"mt-8 text-center text-gray-400 text-sm",children:[(0,a.jsx)("p",{children:"※ 購入したポイントの払い戻しはできません"}),(0,a.jsx)("p",{children:"※ 無料ポイントから優先的に消費されます"})]}),(0,a.jsx)("div",{className:"mt-8 text-center",children:(0,a.jsx)(i(),{href:"/gacha",className:"inline-block px-8 py-3 bg-gray-600 hover:bg-gray-700 rounded-lg font-bold transition-colors",children:"ガチャに戻る"})})]})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[6874,3568,4982,1720,8441,1684,7358],()=>s(2764)),_N_E=e.O()}]);